<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:107%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;
	font-weight:normal;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:2.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:107%;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;
	font-weight:normal;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:2.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:107%;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#1F4D78;
	font-weight:normal;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	letter-spacing:-.5pt;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	letter-spacing:-.5pt;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	letter-spacing:-.5pt;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	letter-spacing:-.5pt;}
a:link, span.MsoHyperlink
	{color:#0563C1;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:#954F72;
	text-decoration:underline;}
p
	{margin-right:0in;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:.5in;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:.5in;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoIntenseQuote, li.MsoIntenseQuote, div.MsoIntenseQuote
	{mso-style-link:"Intense Quote Char";
	margin-top:.25in;
	margin-right:.6in;
	margin-bottom:.25in;
	margin-left:.6in;
	text-align:center;
	line-height:107%;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	color:#5B9BD5;
	font-style:italic;}
span.MsoSubtleEmphasis
	{color:#404040;
	font-style:italic;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;}
span.IntenseQuoteChar
	{mso-style-name:"Intense Quote Char";
	mso-style-link:"Intense Quote";
	color:#5B9BD5;
	font-style:italic;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-link:Title;
	font-family:"Calibri Light",sans-serif;
	letter-spacing:-.5pt;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Calibri Light",sans-serif;
	color:#1F4D78;}
.MsoChpDefault
	{font-family:"Calibri",sans-serif;}
.MsoPapDefault
	{margin-bottom:8.0pt;
	line-height:107%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link="#0563C1" vlink="#954F72">

<div class=WordSection1>

<p class=MsoTitle style='margin-bottom:12.0pt'>Analyzing, Improving, and
Testing a Small Program [Draft]</p>

<p class=MsoNormal style='line-height:normal'>This article analyzes a simple
program and discusses how it can be improved and tested. The idea is to walk
through several iterations of a program to see how it evolves, which mirrors
iterations of refactoring I have performed during my own work.</p>

<p class=MsoNormal style='line-height:normal'><span style='color:black'>The
program calls a web service to retrieve a list of builds and prints out the
highest ranking build, where the ranking of a build is the length of its build
number (the higher the better). </span></p>

<p class=MsoNormal style='line-height:normal'><span style='color:black'>Builds
are queried by their id using the Visual Studio Team Services (VSTS) REST API
through the use of a Nuget package </span><span style='color:#5B9BD5'>VSORestAPI</span><span
style='color:black'>. </span><span style='color:black'>The build ids to query
are located in a text file called <i>buildsIds.txt</i> that exists on the
Desktop directory of the host machine. The program parses <i>buildIds.txt</i>
to retrieve the list of build ids to query, queries the builds, and then returns
the highest ranking build. </span></p>

<p class=MsoNormal style='line-height:normal'><a href="#_Initial_Version_(No">Initial
Version</a><span style='color:black'> (</span><a href="#_Commentary_On_Initial">Commentary</a><span
style='color:black'>)</span></p>

<p class=MsoNormal style='line-height:normal'><a href="#_Iteration_1">Iteration
1</a><span style='color:black'> (</span><a href="#_Commentary_On_Iteration">Commentary</a><span
style='color:black'>)</span></p>

<p class=MsoNormal style='line-height:normal'><a href="#_Iteration_2">Iteration
2</a><span style='color:black'> (</span><a href="#_Commentary_On_Iteration_1">Commentary</a><span
style='color:black'>)</span></p>

<p class=MsoNormal style='line-height:normal'><a href="#_Iteration_3">Iteration
3</a><span style='color:black'> (</span><a href="#_Commentary_On_Iteration_2">Commentary</a><span
style='color:black'>)</span></p>

<h1 style='margin-bottom:6.0pt'><a name="_Initial_Version_(No"></a><span
style='font-size:18.0pt;line-height:107%'>Initial Version (No Unit Tests)</span></h1>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width=705
 style='width:528.55pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=705 valign=top style='width:528.55pt;border:solid windowtext 1.0pt;
  background:#E7F0F9;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System.Collections.Generic;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System.IO;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System.Linq;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> VSORestAPI;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>class</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Program</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>{</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>static</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>void</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> Main(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>[] args)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> account = args[0];</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> project = args[1];</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> bestBuild = GetTopRankedBuild(account, project);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Console</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.WriteLine(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#A31515'>$&quot;The top ranked build is </span><span style='font-size:
  9.5pt;font-family:Consolas;color:black'>{bestBuild.BuildNumber}</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;summary&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> Retrieves the top ranked build.</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;/summary&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;param name=&quot;</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>account</span><span style='font-size:9.5pt;
  font-family:Consolas;color:gray'>&quot;&gt;</span><span style='font-size:
  9.5pt;font-family:Consolas;color:green'>the VSTS account the builds were
  launched on</span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;/param&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;param name=&quot;</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>project</span><span style='font-size:9.5pt;
  font-family:Consolas;color:gray'>&quot;&gt;</span><span style='font-size:
  9.5pt;font-family:Consolas;color:green'>the VSTS project the builds were
  launched on</span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;/param&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;returns&gt;</span><span style='font-size:9.5pt;font-family:
  Consolas;color:green'>the top ranked build, or null if there are no builds</span><span
  style='font-size:9.5pt;font-family:Consolas;color:gray'>&lt;/returns&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>internal</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>static</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Build</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> GetTopRankedBuild(</span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>string</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> account, </span><span style='font-size:
  9.5pt;font-family:Consolas;color:blue'>string</span><span style='font-size:
  9.5pt;font-family:Consolas;color:black'> project)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> windowsDir = </span><span style='font-size:9.5pt;font-family:
  Consolas;color:#2B91AF'>Environment</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>.GetFolderPath(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>Environment</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>SpecialFolder</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.Desktop);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildIds = </span><span style='font-size:9.5pt;font-family:
  Consolas;color:#2B91AF'>File</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>.ReadAllLines(</span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>Path</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>.Combine(windowsDir, </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;buildIds.txt&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>));</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> builds = </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>new</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>List</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&lt;</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Build</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&gt;();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>foreach</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> (</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildId </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>in</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildIds.Select(x =&gt; </span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>int</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>.Parse(x)))</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> build = </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>BuildAPI</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.GetBuild(account, project, buildId);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            builds.Add(build);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>return</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> builds.OrderByDescending(x =&gt;
  x.BuildNumber.Length).FirstOrDefault();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:9.5pt;font-family:Consolas;color:black'>}</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>&nbsp;</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<h1 style='margin-bottom:12.0pt'><a name="_Commentary_On_Initial"></a><span
style='font-size:18.0pt;line-height:107%'>Commentary On Initial Version</span></h1>

<p class=MsoNormal>Even the smallest of programs can fail in a surprisingly
large number of ways. Look through the code and try to identify assumptions that
lead to failure.</p>

<h2 style='margin-bottom:6.0pt'>Points of Failure</h2>

<p class=MsoNormal style='line-height:normal'>The program can fail in many
ways:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>If the program is passed less than two arguments, the index into <span
style='color:#4472C4'>args </span>throws an <span style='color:#C00000'>IndexOutOfBoundsException</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The arguments to <span style='color:#4472C4'>GetTopRankedBuild </span>are
not validated</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>If <i>buildIds.txt</i> does not exist, </span><span
style='color:#4472C4'>File.ReadAllLines</span><span style='color:black'> throws
a </span><span style='color:#C00000'>FileNotFoundException</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>The content of <i>buildIds.txt</i> may
not contain the list integers the program is expecting, causing the call to </span><span
style='color:#4472C4'>int.Parse </span><span style='color:black'>to throw a </span><span
style='color:#C00000'>FormatException</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>The call to </span><span
style='color:#4472C4'>vsts.GetBuild</span><span style='color:#5B9BD5'> </span><span
style='color:black'>may throw an exception. Without reading the documentation
of </span><span style='color:#4472C4'>VSORestAPI</span><span style='color:black'>,
we have no way of knowing which exceptions it may throw</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>If the build object returned by</span><span
style='color:#4472C4'> vsts.GetBuild</span><span style='color:#5B9BD5'>  </span><span
style='color:black'>is null or its </span><span style='color:#4472C4'>BuildNumber</span><span
style='color:black'> property is null, the call to </span><span
style='color:#4472C4'>builds.OrderByDescending</span><span style='color:black'>
throws a </span><span style='color:#C00000'>NullReferenceException</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>The path specified by </span><span
style='color:#4472C4'>Environment.SpecialFolder.Desktop </span><span
style='color:black'>may not be reliable. For example, can this location depend
on the logged on user?</span></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>If </span><span style='color:#4472C4'>GetTopRankedBuild
</span><span style='color:black'>returns null, </span><span style='color:#4472C4'>Main
</span><span style='color:black'>will crash trying to print the build number of
the best build</span></p>

<p class=MsoNormal style='line-height:normal'><span style='color:black'>Dealing
with failure scenarios is difficult and frustrating. Unlike the </span><a
href="https://en.wikipedia.org/wiki/Happy_path">happy path</a><span
style='color:black'>, how to handle a failure scenario is often undefined or
ambigious. For example, if <i>buildIds.txt</i> gets corrupted, how should the
program recover, if at all? For a small program such as this, letting it crash
and burn is often okay, but when writing code other programmers will take depend
on, it is important to define and handle each failure scenario. </span></p>

<p class=MsoNormal style='line-height:normal'><span style='color:black'>Other
common assumptions that lead to failures include:</span></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i><span style='color:black'>Concurreny assumption</span></i><span
style='color:black'>: my code is executed on a single thread </span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i><span style='color:black'>Globalization assumption</span></i><span
style='color:black'>: my code is executed in the same timezone </span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i><span style='color:black'>Environment assumption</span></i><span
style='color:black'>: my code is executed on the same hardware and software
stack</span></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i><span style='color:black'>Localization assumption</span></i><span
style='color:black'>: my code is executed by English users only</span></p>

<h2 style='margin-bottom:6.0pt'>Performance Concerns</h2>

<p class=MsoNormal style='line-height:normal'><span style='color:black'>There
are also serious performance concerns:</span></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>How large is <i>buildIds.txt</i>? For
each build id, the program makes an HTTP request to retrieve the build</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>How long does an HTTP request to VSTS
take? </span></p>

<p class=MsoListParagraphCxSpLast style='margin-left:1.0in;text-indent:-.25in;
line-height:125%'><span style='font-family:"Courier New";color:black'>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><span
style='color:black'>What happens if the service is offline or is taking a long
time to reply?</span></p>

<h2 style='margin-bottom:6.0pt'>Unit Testing Impediments</h2>

<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:
Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Testing the program depends on making an HTTP call (or several)
to VSTS, thus any unit test requires an Internet connection and retrieving
real, persistent, data from VSTS</p>

<h1 style='margin-bottom:6.0pt'><a name="_Iteration_1"></a><span
style='font-size:18.0pt;line-height:107%'>Iteration 1</span></h1>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width=1409
 style='width:1057.1pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=705 valign=top style='width:528.55pt;border:solid windowtext 1.0pt;
  border-bottom:none;background:#F2F2F2;padding:0in 5.4pt 0in 5.4pt'>
  <h2 align=center style='text-align:center;line-height:normal'><a
  name="_Program_(Iteration_1)"></a>Program (Iteration 1)</h2>
  </td>
  <td width=705 valign=top style='width:528.55pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:none;border-right:solid windowtext 1.0pt;
  background:#F2F2F2;padding:0in 5.4pt 0in 5.4pt'>
  <h2 align=center style='text-align:center;line-height:normal'>Unit Tests
  (Iteration 1)</h2>
  </td>
 </tr>
 <tr>
  <td width=705 valign=top style='width:528.55pt;border:solid windowtext 1.0pt;
  border-top:none;background:#E7F0F9;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System.Collections.Generic;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System.IO;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System.Linq;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> VSORestAPI;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>interface</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IVsts</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>{</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Build</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> GetBuild(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> account, </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> project, </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>int</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildId);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>}</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>class</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>HttpVsts</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> : </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IVsts</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>{</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Build</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> GetBuild(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> account, </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> project, </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>int</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildId)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>return</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>BuildAPI</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.GetBuild(account, project, buildId);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>}</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>class</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Program</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>{</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>internal</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>static</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IVsts</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> vsts = </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>new</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>HttpVsts</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>static</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>void</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> Main(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>[] args)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> account = args[0];</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> project = args[1];</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> bestBuild = GetTopRankedBuild(account, project);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>if</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> (bestBuild != </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>null</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            </span><span style='font-size:9.5pt;font-family:
  Consolas;color:#2B91AF'>Console</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>.WriteLine(</span><span style='font-size:
  9.5pt;font-family:Consolas;color:#A31515'>$&quot;The top ranked build is </span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>{bestBuild.BuildNumber}</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>else</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            </span><span style='font-size:9.5pt;font-family:
  Consolas;color:#2B91AF'>Console</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>.WriteLine(</span><span style='font-size:
  9.5pt;font-family:Consolas;color:#A31515'>&quot;No builds on this machine&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;summary&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> Retrieves the top ranked build.</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;/summary&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;param name=&quot;</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>account</span><span style='font-size:9.5pt;
  font-family:Consolas;color:gray'>&quot;&gt;</span><span style='font-size:
  9.5pt;font-family:Consolas;color:green'>the VSTS account the builds were
  launched on</span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;/param&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;param name=&quot;</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>project</span><span style='font-size:9.5pt;
  font-family:Consolas;color:gray'>&quot;&gt;</span><span style='font-size:
  9.5pt;font-family:Consolas;color:green'>the VSTS project the builds were launched
  on</span><span style='font-size:9.5pt;font-family:Consolas;color:gray'>&lt;/param&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;returns&gt;</span><span style='font-size:9.5pt;font-family:
  Consolas;color:green'>the top ranked build, or null if there are no builds</span><span
  style='font-size:9.5pt;font-family:Consolas;color:gray'>&lt;/returns&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>internal</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>static</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Build</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> GetTopRankedBuild(</span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>string</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> account, </span><span style='font-size:
  9.5pt;font-family:Consolas;color:blue'>string</span><span style='font-size:
  9.5pt;font-family:Consolas;color:black'> project)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>if</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> (</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.IsNullOrWhiteSpace(account)) </span><span style='font-size:
  9.5pt;font-family:Consolas;color:blue'>throw</span><span style='font-size:
  9.5pt;font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>new</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>ArgumentException</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>nameof</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>(account));</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>if</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> (</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.IsNullOrWhiteSpace(project)) </span><span style='font-size:
  9.5pt;font-family:Consolas;color:blue'>throw</span><span style='font-size:
  9.5pt;font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>new</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>ArgumentException</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>nameof</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>(project));</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> windowsDir = </span><span style='font-size:9.5pt;font-family:
  Consolas;color:#2B91AF'>Environment</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>.GetFolderPath(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>Environment</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>SpecialFolder</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.Desktop);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildIdsFile = </span><span style='font-size:9.5pt;font-family:
  Consolas;color:#2B91AF'>Path</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>.Combine(windowsDir, </span><span style='font-size:
  9.5pt;font-family:Consolas;color:#A31515'>&quot;buildIds.txt&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildIds = </span><span style='font-size:9.5pt;font-family:
  Consolas;color:#2B91AF'>Enumerable</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>.Empty&lt;</span><span style='font-size:
  9.5pt;font-family:Consolas;color:blue'>int</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>&gt;();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>if</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> (</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>File</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.Exists(buildIdsFile))</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildIdsContent = </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>File</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>.ReadAllLines(buildIdsFile);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>try</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>                buildIds = buildIdsContent.Select(x =&gt; </span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>int</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.Parse(x));</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>catch</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> (</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>FormatException</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> e)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>                </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> content = </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.Join(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Environment</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>.NewLine, buildIdsContent);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>                </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>throw</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>new</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>InvalidOperationException</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>(</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>                    </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#A31515'>$&quot;Malformed </span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>{buildIdsFile}</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>: </span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>{content}</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>, e);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> builds = </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>new</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>List</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&lt;</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Build</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&gt;();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>foreach</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> (</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildId </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>in</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildIds)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> build = vsts.GetBuild(account, project, buildId);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            builds.Add(build);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>return</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> builds</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            .OrderByDescending(x =&gt; x?.BuildNumber == </span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>null</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'> ? 0 :
  x.BuildNumber.Length)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            .FirstOrDefault();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:9.5pt;font-family:Consolas;color:black'>}</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>&nbsp;</p>
  </td>
  <td width=705 valign=top style='width:528.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  background:#E7F0F9;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System.Collections.Generic;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System.Linq;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> Microsoft.VisualStudio.TestTools.UnitTesting;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> VSORestAPI;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System.IO;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>class</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>TestVsts</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> : </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IVsts</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>{</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>List</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&lt;</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Build</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&gt; Builds;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>int</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> NumberOfQueries;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> TestVsts()</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        Builds = </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>new</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>List</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&lt;</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Build</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&gt;();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        NumberOfQueries = 0;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>void</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> AddBuild(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>int</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildId, </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildNumber)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        Builds.Add(</span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>new</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>Build</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> { Id = buildId, BuildNumber = buildNumber
  });</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Build</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> GetBuild(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> account, </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> project, </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>int</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildId)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        NumberOfQueries++;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>return</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> Builds.SingleOrDefault(x =&gt; x.Id == buildId);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>}</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>[</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>TestClass</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>]</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>class</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>UnitTests</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>{</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>private</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>TestVsts</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> vsts;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    [</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>TestInitialize</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>]</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>void</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> Initialize()</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        vsts = </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>new</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>TestVsts</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        vsts.AddBuild(1, </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#A31515'>&quot;firstBuild&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        vsts.AddBuild(2, </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#A31515'>&quot;secondBuild&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        vsts.AddBuild(3, </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#A31515'>&quot;theHighestRankingBuild&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Program</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.vsts = vsts;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> desktopDir = </span><span style='font-size:9.5pt;font-family:
  Consolas;color:#2B91AF'>Environment</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>.GetFolderPath(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>Environment</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>SpecialFolder</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.Desktop);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>File</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.WriteAllLines(</span><span style='font-size:9.5pt;font-family:
  Consolas;color:#2B91AF'>Path</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>.Combine(desktopDir, </span><span style='font-size:
  9.5pt;font-family:Consolas;color:#A31515'>&quot;buildIds.txt&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>), </span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>new</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>[] { </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;1&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>, </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;2&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'> });</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    [</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>TestMethod</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>]</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>void</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> GetTopRankedBuild_ReturnsBestBuild_Test()</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> build = </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Program</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.GetTopRankedBuild(</span><span style='font-size:9.5pt;
  font-family:Consolas;color:#A31515'>&quot;blah&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>, </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;blah&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Assert</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.AreEqual(2, build.Id);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Assert</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.AreEqual(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#A31515'>&quot;secondBuild&quot;</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>, build.BuildNumber);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    [</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>TestMethod</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>]</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>void</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> GetTopRankedBuild_QueriesEachBuildInBuildIds_Test()</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> build = </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Program</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.GetTopRankedBuild(</span><span style='font-size:9.5pt;
  font-family:Consolas;color:#A31515'>&quot;blah&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>, </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;blah&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Assert</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.AreEqual(2, vsts.NumberOfQueries);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:9.5pt;font-family:Consolas;color:black'>}</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black'>&nbsp;</span></p>

<h1 style='margin-bottom:12.0pt'><a name="_Commentary_On_Iteration"></a><span
style='font-size:18.0pt;line-height:107%'>Commentary On Iteration 1</span></h1>

<p class=MsoNormal>The first iteration addresses a several failure scenarios
and adds a unit test suite.</p>

<h2 style='margin-bottom:6.0pt'>Failure Scenario Improvements</h2>

<p class=MsoNormal style='line-height:normal'>First, the <span
style='color:#4472C4'>GetTopRankedBuild </span>method validates that parameters
<span style='color:#4472C4'>account </span>and <span style='color:#4472C4'>project
</span>are non-null and non-empty. Next, the existence of <i>buildIds.txt</i>
is verified before trying to read it. If a <span style='color:#C00000'>FormatException
</span>is thrown while parsing the content of <i>buildIds.txt</i>, it is
caught, and an <span style='color:#C00000'>InvalidOperation </span>is thrown
that includes the path and content of <i>buildsIds.txt</i> in the exception
message. A possible <span style='color:#C00000'>NullReferenceException </span>is
avoiding when ranking builds by assigning a rank of zero to builds that are
null or have a null BuildNumber property. Finally, <span style='color:#4472C4'>Main
</span>includes a conditional statement checking if the object returned by <span
style='color:#4472C4'>GetTopRankedBuild </span>is null.</p>

<h2 style='margin-bottom:6.0pt'>Unit Tests</h2>

<p class=MsoNormal style='line-height:normal'><span style='color:black'>The
following changes allow the program to be more easily unit tested:</span></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;line-height:125%'><span
style='color:black'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>The VSTS service is exposed via the </span><span
style='color:#4472C4'>IVsts </span><span style='color:black'>interface</span></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;line-height:125%'><span
style='color:black'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>The VSTS service used by program is a
static field</span></p>

<p class=MsoNormal style='line-height:normal'>During a test run, the <span
style='color:#4472C4'>TestInitialize </span>function sets the <span
style='color:#4472C4'>IVsts </span>service to an instance of <span
style='color:#4472C4'>TestVsts</span>, so the service can be mocked. A tenet of
good testing is mocking (read: controlling) all parts of the program, except
for the portion (a.k.a. unit) you want to test.</p>

<h2 style='margin-bottom:6.0pt'>Unit Test Shortcomings</h2>

<p class=MsoNormal style='line-height:normal'>There are still several issues
with this iteration of the unit tests:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The file system is not mocked, so the unit tests must create <i>buildIds.txt</i>
on the desktop of the test machine. <b>Any data retrieval outside main memory
should be viewed as an external service</b></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The program relies on global state, which is a bad programming
practice. Each unit test must set global memory, and then possibly reset it upon
completion</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>A change to the <span style='color:#4472C4'>IVsts </span>interface
requires a change to the testing implementation (<span style='color:#4472C4'>TestVsts</span>),
in addition to the actual implementation (<span style='color:#4472C4'>HttpVsts</span>),
even though an addition to the interface should not affect any tests</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The testing implementation (<span style='color:#4472C4'>TestVsts</span>)
itself is code to write and maintain, and may can contain bugs</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>If there are many interfaces, writing test implementations of all
the programs interface is burdensome work</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in;
line-height:125%'><span style='font-family:"Courier New"'>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span>Lots of
boilerplate code may be required. For example, to test that an interface method
is called with a set of parameters, the testing implementation must record each
time it is called and its parameter values</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The current unit tests only test the case where the program
behaves as expected, not when it fails</p>

<p class=MsoNormal style='line-height:normal'>The program and its tests could
be improved if we:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Introduce an additional interface that exposes the file system as
a service</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;line-height:125%'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Introduce a mocking framework to avoid writing test
implementations of service interfaces</p>

<p class=MsoListParagraphCxSpLast style='margin-left:1.0in;text-indent:-.25in;
line-height:125%'><span style='font-family:"Courier New"'>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span>In this
example, the <a href="https://github.com/moq/moq4">Moq</a> framework will be
used</p>

<h1 style='margin-bottom:6.0pt'><a name="_Iteration_2"></a><span
style='font-size:18.0pt;line-height:107%'>Iteration 2</span></h1>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width=1409
 style='width:1057.1pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=720 valign=top style='width:7.5in;border:solid windowtext 1.0pt;
  border-bottom:none;background:#F2F2F2;padding:0in 5.4pt 0in 5.4pt'>
  <h2 align=center style='text-align:center;line-height:normal'><a
  name="_Program_(Iteration_2)"></a>Program (Iteration 2)</h2>
  </td>
  <td width=720 valign=top style='width:7.5in;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:none;border-right:solid windowtext 1.0pt;
  background:#F2F2F2;padding:0in 5.4pt 0in 5.4pt'>
  <h2 align=center style='text-align:center;line-height:normal'>Unit Tests
  (Iteration 2)</h2>
  </td>
 </tr>
 <tr>
  <td width=720 valign=top style='width:7.5in;border-top:none;border-left:solid windowtext 1.0pt;
  border-bottom:none;border-right:solid windowtext 1.0pt;background:#E7F0F9;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System.Collections.Generic;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System.IO;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System.Linq;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> VSORestAPI;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>interface</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IVsts</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>{</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Build</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> GetBuild(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> account, </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> project, </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>int</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildId);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>}</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>class</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>HttpVsts</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> : </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IVsts</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>{</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Build</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> GetBuild(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> account, </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> project, </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>int</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildId)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>return</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>BuildAPI</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.GetBuild(account, project, buildId);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>}</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>interface</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IFileSystem</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>{</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>[] ReadAllLines(</span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>string</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> path);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>bool</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> FileExists(</span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>string</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> path);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>}</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>class</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>FileSytem</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> : </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IFileSystem</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>{</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>[] ReadAllLines(</span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>string</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> path)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>return</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>File</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.ReadAllLines(path);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>bool</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> FileExists(</span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>string</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> path)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>return</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>File</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.Exists(path);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>}</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>class</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Program</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>{</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>internal</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>static</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IVsts</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> vsts;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>internal</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>static</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IFileSystem</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> fileSystem;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>private</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>static</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>void</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> CreateServices()</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        vsts = </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>new</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>HttpVsts</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        fileSystem = </span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>new</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>FileSytem</span><span style='font-size:
  9.5pt;font-family:Consolas;color:black'>();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>static</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>void</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> Main(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>[] args)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        CreateServices();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> account = args[0];</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> project = args[1];</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> bestBuild = GetTopRankedBuild(account, project);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Console</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.WriteLine(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#A31515'>$&quot;The top ranked build is </span><span style='font-size:
  9.5pt;font-family:Consolas;color:black'>{bestBuild.BuildNumber}</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;summary&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> Retrieves the top ranked build.</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;/summary&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;param name=&quot;</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>account</span><span style='font-size:9.5pt;
  font-family:Consolas;color:gray'>&quot;&gt;</span><span style='font-size:
  9.5pt;font-family:Consolas;color:green'>the VSTS account the builds were
  launched on</span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;/param&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;param name=&quot;</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>project</span><span style='font-size:9.5pt;
  font-family:Consolas;color:gray'>&quot;&gt;</span><span style='font-size:
  9.5pt;font-family:Consolas;color:green'>the VSTS project the builds were
  launched on</span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;/param&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;returns&gt;</span><span style='font-size:9.5pt;font-family:
  Consolas;color:green'>the top ranked build, or null if there are no builds</span><span
  style='font-size:9.5pt;font-family:Consolas;color:gray'>&lt;/returns&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>internal</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>static</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Build</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> GetTopRankedBuild(</span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>string</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> account, </span><span style='font-size:
  9.5pt;font-family:Consolas;color:blue'>string</span><span style='font-size:
  9.5pt;font-family:Consolas;color:black'> project)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>if</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> (</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.IsNullOrWhiteSpace(account)) </span><span style='font-size:
  9.5pt;font-family:Consolas;color:blue'>throw</span><span style='font-size:
  9.5pt;font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>new</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>ArgumentException</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>nameof</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>(account));</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>if</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> (</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.IsNullOrWhiteSpace(project)) </span><span style='font-size:
  9.5pt;font-family:Consolas;color:blue'>throw</span><span style='font-size:
  9.5pt;font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>new</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>ArgumentException</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>nameof</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>(project));</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> windowsDir = </span><span style='font-size:9.5pt;font-family:
  Consolas;color:#2B91AF'>Environment</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>.GetFolderPath(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>Environment</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>SpecialFolder</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.Desktop);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildIdsFile = </span><span style='font-size:9.5pt;font-family:
  Consolas;color:#2B91AF'>Path</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>.Combine(windowsDir, </span><span style='font-size:
  9.5pt;font-family:Consolas;color:#A31515'>&quot;buildIds.txt&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildIds = </span><span style='font-size:9.5pt;font-family:
  Consolas;color:#2B91AF'>Enumerable</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>.Empty&lt;</span><span style='font-size:
  9.5pt;font-family:Consolas;color:blue'>int</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>&gt;();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>if</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> (fileSystem.FileExists(buildIdsFile))</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildIdsContent = fileSystem.ReadAllLines(buildIdsFile);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>try</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>                buildIds = buildIdsContent.Select(x =&gt; </span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>int</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.Parse(x));</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>catch</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> (</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>FormatException</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> e)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>                </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> content = </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.Join(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Environment</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>.NewLine, buildIdsContent);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>                </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>throw</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>new</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>InvalidOperationException</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>(</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>                    </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#A31515'>$&quot;Malformed </span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>{buildIdsFile}</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>: </span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>{content}</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>, e);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> builds = </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>new</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>List</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&lt;</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Build</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&gt;();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>foreach</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> (</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildId </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>in</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildIds)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> build = vsts.GetBuild(account, project, buildId);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            builds.Add(build);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>return</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> builds</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            .OrderByDescending(x =&gt; x?.BuildNumber == </span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>null</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'> ? 0 :
  x.BuildNumber.Length)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            .FirstOrDefault();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:9.5pt;font-family:Consolas;color:black'>}</span></p>
  </td>
  <td width=720 valign=top style='width:7.5in;border:none;border-right:solid windowtext 1.0pt;
  background:#E7F0F9;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> Microsoft.VisualStudio.TestTools.UnitTesting;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> Moq;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> Sample2;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> VSORestAPI;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>[</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>TestClass</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>]</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>class</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>UnitTests</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>{</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Mock</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&lt;</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IVsts</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&gt; vsts;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Mock</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&lt;</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IFileSystem</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>&gt; fileSystem;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    [</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>TestInitialize</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>]</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>void</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> Initialize()</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        vsts = </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>new</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Mock</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&lt;</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IVsts</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&gt;();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        vsts.Setup(x =&gt; x.GetBuild(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), 1))</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>                .Returns(</span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>new</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>Build</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>() { Id = 1, BuildNumber = </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;firstBuild&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'> });</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        vsts.Setup(x =&gt; x.GetBuild(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), 2))</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>                .Returns(</span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>new</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>Build</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>() { Id = 2, BuildNumber = </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;secondBuild&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'> });</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        vsts.Setup(x =&gt; x.GetBuild(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), 3))</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>                .Returns(</span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>new</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>Build</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>() { Id = 3, BuildNumber = </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;theHighestRankingBuild&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'> });</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Program</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.vsts = vsts.Object;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        fileSystem = </span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>new</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>Mock</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>&lt;</span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>IFileSystem</span><span style='font-size:
  9.5pt;font-family:Consolas;color:black'>&gt;();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        fileSystem.Setup(x =&gt; x.ReadAllLines(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;())).Returns(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>new</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>[] { </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;1&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>, </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;2&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'> });</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        fileSystem.Setup(x =&gt; x.FileExists(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;())).Returns(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>true</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    [</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>TestMethod</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>]</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>void</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> GetTopRankedBuild_ReturnsBestBuild_Test()</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> build = </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Program</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.GetTopRankedBuild(</span><span style='font-size:9.5pt;
  font-family:Consolas;color:#A31515'>&quot;blah&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>, </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;blah&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Assert</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.AreEqual(2, build.Id);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Assert</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.AreEqual(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#A31515'>&quot;secondBuild&quot;</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>, build.BuildNumber);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    [</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>TestMethod</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>]</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>void</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> GetTopRankedBuild_QueriesEachBuildInBuildIds_Test()</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> build = </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Program</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.GetTopRankedBuild(</span><span style='font-size:9.5pt;
  font-family:Consolas;color:#A31515'>&quot;blah&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>, </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;blah&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        vsts.Verify(x =&gt; x.GetBuild(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), 1), </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>Times</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.Once);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        vsts.Verify(x =&gt; x.GetBuild(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), 2), </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>Times</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.Once);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:9.5pt;font-family:Consolas;color:black'>}</span></p>
  </td>
 </tr>
 <tr>
  <td width=720 valign=top style='width:7.5in;border:solid windowtext 1.0pt;
  border-top:none;background:#E7F0F9;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>&nbsp;</span></p>
  </td>
  <td width=720 valign=top style='width:7.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  background:#E7F0F9;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>&nbsp;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<h1 style='margin-bottom:12.0pt'><a name="_Commentary_On_Iteration_1"></a><span
style='font-size:18.0pt;line-height:107%'>Commentary On Iteration 2</span></h1>

<p class=MsoNormal>The file system is now mocked, so the unit tests no longer must
create<i> buildIds.txt </i>on the Desktop of the test machine. Instead, the Moq
framework mocks the <span style='color:#4472C4'>IFileSystem </span>interface to
fake the existence of <i>buildIds.txt</i> and its content. The <span
style='color:#4472C4'>TestVsts </span>class is removed and is replaced by a Moq
implementation.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'>The following two lines of code is an example of
how mock objects are controlled using Moq:</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black'>vsts = </span><span style='font-size:9.5pt;font-family:Consolas;
color:blue'>new</span><span style='font-size:9.5pt;font-family:Consolas;
color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
color:#2B91AF'>Mock</span><span style='font-size:9.5pt;font-family:Consolas;
color:black'>&lt;</span><span style='font-size:9.5pt;font-family:Consolas;
color:#2B91AF'>IVsts</span><span style='font-size:9.5pt;font-family:Consolas;
color:black'>&gt;();</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black'>vsts.Setup(x =&gt; x.GetBuild(</span><span style='font-size:9.5pt;
font-family:Consolas;color:#2B91AF'>It</span><span style='font-size:9.5pt;
font-family:Consolas;color:black'>.IsAny&lt;</span><span style='font-size:9.5pt;
font-family:Consolas;color:blue'>string</span><span style='font-size:9.5pt;
font-family:Consolas;color:black'>&gt;(), </span><span style='font-size:9.5pt;
font-family:Consolas;color:#2B91AF'>It</span><span style='font-size:9.5pt;
font-family:Consolas;color:black'>.IsAny&lt;</span><span style='font-size:9.5pt;
font-family:Consolas;color:blue'>string</span><span style='font-size:9.5pt;
font-family:Consolas;color:black'>&gt;(), 1)).Returns(</span><span
style='font-size:9.5pt;font-family:Consolas;color:blue'>new</span><span
style='font-size:9.5pt;font-family:Consolas;color:black'> </span><span
style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>Build</span><span
style='font-size:9.5pt;font-family:Consolas;color:black'>() { Id = 1,
BuildNumber = </span><span style='font-size:9.5pt;font-family:Consolas;
color:#A31515'>&quot;firstBuild&quot;</span><span style='font-size:9.5pt;
font-family:Consolas;color:black'> });</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black'>&nbsp;</span></p>

<p class=MsoNormal>This is telling Moq that any call to <span style='color:
#4472C4'>IVsts.GetBuild </span>where the build id is 1 (the third parameter)
should return a <span style='color:#4472C4'>Build </span>object whose id is 1
and <span style='color:#4472C4'>BuildNumber </span>is firstBuild. The <span
style='color:#4472C4'>IFileSystem </span>is mocked the same way.</p>

<p class=MsoNormal style='line-height:normal'>Similiarly, the following line
verifies that <span style='color:#4472C4'>IVsts.GetBuild </span>was called one
time when a build id of 1 was passed to it:</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black'>vsts.Verify(x =&gt; x.GetBuild(</span><span style='font-size:9.5pt;
font-family:Consolas;color:#2B91AF'>It</span><span style='font-size:9.5pt;
font-family:Consolas;color:black'>.IsAny&lt;</span><span style='font-size:9.5pt;
font-family:Consolas;color:blue'>string</span><span style='font-size:9.5pt;
font-family:Consolas;color:black'>&gt;(), </span><span style='font-size:9.5pt;
font-family:Consolas;color:#2B91AF'>It</span><span style='font-size:9.5pt;
font-family:Consolas;color:black'>.IsAny&lt;</span><span style='font-size:9.5pt;
font-family:Consolas;color:blue'>string</span><span style='font-size:9.5pt;
font-family:Consolas;color:black'>&gt;(), 1), </span><span style='font-size:
9.5pt;font-family:Consolas;color:#2B91AF'>Times</span><span style='font-size:
9.5pt;font-family:Consolas;color:black'>.Once);</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'>&nbsp;</p>

<p class=MsoNormal style='line-height:normal'>This functionality completely
replaces functionality that was implemented in <span style='color:#4472C4'>TestVsts</span>.
Pretty nice, huh?</p>

<p class=MsoNormal style='line-height:normal'>An issue with this iteration of
the program is the unit tests must still set the global state of the program to
run the tests.</p>

<h1 style='margin-bottom:6.0pt'><a name="_Iteration_3"></a><span
style='font-size:18.0pt;line-height:107%'>Iteration 3</span></h1>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width=1409
 style='width:1057.1pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=720 valign=top style='width:7.5in;border:solid windowtext 1.0pt;
  border-bottom:none;background:#F2F2F2;padding:0in 5.4pt 0in 5.4pt'>
  <h2 align=center style='text-align:center;line-height:normal'><a
  name="_Program_(Iteration_3)"></a>Program (Iteration 3)</h2>
  </td>
  <td width=720 valign=top style='width:7.5in;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:none;border-right:solid windowtext 1.0pt;
  background:#F2F2F2;padding:0in 5.4pt 0in 5.4pt'>
  <h2 align=center style='text-align:center;line-height:normal'>Unit Tests
  (Iteration 3)</h2>
  </td>
 </tr>
 <tr>
  <td width=720 valign=top style='width:7.5in;border:solid windowtext 1.0pt;
  border-top:none;background:#E7F0F9;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System.Collections.Generic;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System.IO;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> System.Linq;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> VSORestAPI;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>interface</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IVsts</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>{</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Build</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> GetBuild(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> account, </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> project, </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>int</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildId);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>}</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>class</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>HttpVsts</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> : </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IVsts</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>{</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Build</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> GetBuild(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> account, </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> project, </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>int</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildId)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>return</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>BuildAPI</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.GetBuild(account, project, buildId);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>}</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>interface</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IFileSystem</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>{</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>[] ReadAllLines(</span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>string</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> path);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>bool</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> FileExists(</span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>string</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> path);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>}</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>class</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>FileSytem</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> : </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IFileSystem</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>{</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>[] ReadAllLines(</span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>string</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> path)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>return</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>File</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.ReadAllLines(path);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>bool</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> FileExists(</span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>string</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> path)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>return</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>File</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.Exists(path);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>}</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>class</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>ServiceProvider</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>{</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IVsts</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> vsts = </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>new</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>HttpVsts</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IFileSystem</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> fileSystem = </span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>new</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>FileSytem</span><span style='font-size:
  9.5pt;font-family:Consolas;color:black'>();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>}</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>class</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Program</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>{</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>static</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>void</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> Main(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>[] args)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> account = args[0];</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> project = args[1];</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> bestBuild = GetTopRankedBuild(</span><span style='font-size:
  9.5pt;font-family:Consolas;color:blue'>new</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>ServiceProvider</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>(), account,
  project);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Console</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.WriteLine(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#A31515'>$&quot;The top ranked build is </span><span style='font-size:
  9.5pt;font-family:Consolas;color:black'>{bestBuild.BuildNumber}</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;summary&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> Retrieves the top ranked build.</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;/summary&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;param name=&quot;</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>sp</span><span style='font-size:9.5pt;
  font-family:Consolas;color:gray'>&quot;&gt;</span><span style='font-size:
  9.5pt;font-family:Consolas;color:green'>the service provider</span><span
  style='font-size:9.5pt;font-family:Consolas;color:gray'>&lt;/param&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;param name=&quot;</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>account</span><span style='font-size:9.5pt;
  font-family:Consolas;color:gray'>&quot;&gt;</span><span style='font-size:
  9.5pt;font-family:Consolas;color:green'>the VSTS account the builds were
  launched on</span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;/param&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;param name=&quot;</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>project</span><span style='font-size:9.5pt;
  font-family:Consolas;color:gray'>&quot;&gt;</span><span style='font-size:
  9.5pt;font-family:Consolas;color:green'>the VSTS project the builds were
  launched on</span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;/param&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>///</span><span style='font-size:9.5pt;font-family:Consolas;
  color:green'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:gray'>&lt;returns&gt;</span><span style='font-size:9.5pt;font-family:
  Consolas;color:green'>the top ranked build, or null if there are no builds</span><span
  style='font-size:9.5pt;font-family:Consolas;color:gray'>&lt;/returns&gt;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>internal</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>static</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Build</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> GetTopRankedBuild(</span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>ServiceProvider</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'> sp, </span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'> account, </span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'> project)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>if</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> (</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.IsNullOrWhiteSpace(account)) </span><span style='font-size:
  9.5pt;font-family:Consolas;color:blue'>throw</span><span style='font-size:
  9.5pt;font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>new</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>ArgumentException</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>nameof</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>(account));</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>if</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> (</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.IsNullOrWhiteSpace(project)) </span><span style='font-size:
  9.5pt;font-family:Consolas;color:blue'>throw</span><span style='font-size:
  9.5pt;font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>new</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>ArgumentException</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>nameof</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>(project));</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> windowsDir = </span><span style='font-size:9.5pt;font-family:
  Consolas;color:#2B91AF'>Environment</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>.GetFolderPath(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>Environment</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>SpecialFolder</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.Desktop);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildIdsFile = </span><span style='font-size:9.5pt;font-family:
  Consolas;color:#2B91AF'>Path</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>.Combine(windowsDir, </span><span style='font-size:
  9.5pt;font-family:Consolas;color:#A31515'>&quot;buildIds.txt&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildIds = </span><span style='font-size:9.5pt;font-family:
  Consolas;color:#2B91AF'>Enumerable</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>.Empty&lt;</span><span style='font-size:
  9.5pt;font-family:Consolas;color:blue'>int</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>&gt;();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>if</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> (sp.fileSystem.FileExists(buildIdsFile))</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildIdsContent = sp.fileSystem.ReadAllLines(buildIdsFile);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>try</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>                buildIds = buildIdsContent.Select(x =&gt; </span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>int</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.Parse(x));</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>catch</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> (</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>FormatException</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> e)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>                </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> content = </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>string</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.Join(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Environment</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>.NewLine, buildIdsContent);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>                </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>throw</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>new</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>InvalidOperationException</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>(</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>                    </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#A31515'>$&quot;Malformed </span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>{buildIdsFile}</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>: </span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>{content}</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>, e);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> builds = </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>new</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>List</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&lt;</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Build</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&gt;();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>foreach</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> (</span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildId </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>in</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> buildIds)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> build = sp.vsts.GetBuild(account, project, buildId);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            builds.Add(build);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>return</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> builds</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            .OrderByDescending(x =&gt; x?.BuildNumber == </span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>null</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'> ? 0 :
  x.BuildNumber.Length)</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            .FirstOrDefault();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:9.5pt;font-family:Consolas;color:black'>}</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>&nbsp;</p>
  </td>
  <td width=720 valign=top style='width:7.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  background:#E7F0F9;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> Microsoft.VisualStudio.TestTools.UnitTesting;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> Moq;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> Sample3;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>using</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> VSORestAPI;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>[</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>TestClass</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>]</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>class</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>UnitTests</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>{</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>ServiceProvider</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'> sp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Mock</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&lt;</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IVsts</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&gt; vsts;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Mock</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&lt;</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IFileSystem</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>&gt; fileSystem;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    [</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>TestInitialize</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>]</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>void</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> CreateMockServiceProvider()</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        vsts = </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>new</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Mock</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&lt;</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>IVsts</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&gt;();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        vsts.Setup(x =&gt; x.GetBuild(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), 1))</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>                .Returns(</span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>new</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>Build</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>() { Id = 1, BuildNumber = </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;firstBuild&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'> });</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        vsts.Setup(x =&gt; x.GetBuild(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), 2))</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>                .Returns(</span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>new</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>Build</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>() { Id = 2, BuildNumber = </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;secondBuild&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'> });</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        vsts.Setup(x =&gt; x.GetBuild(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), 3))</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>                .Returns(</span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>new</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>Build</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>() { Id = 3, BuildNumber = </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;theHighestRankingBuild&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'> });</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        fileSystem = </span><span style='font-size:9.5pt;
  font-family:Consolas;color:blue'>new</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'> </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>Mock</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>&lt;</span><span style='font-size:9.5pt;
  font-family:Consolas;color:#2B91AF'>IFileSystem</span><span style='font-size:
  9.5pt;font-family:Consolas;color:black'>&gt;();</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        fileSystem.Setup(x =&gt; x.ReadAllLines(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;())).Returns(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>new</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>[] { </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;1&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>, </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;2&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'> });</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        fileSystem.Setup(x =&gt; x.FileExists(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;())).Returns(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>true</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        sp = </span><span style='font-size:9.5pt;font-family:
  Consolas;color:blue'>new</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>ServiceProvider</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>()</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            vsts = vsts.Object,</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>            fileSystem = fileSystem.Object,</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        };</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    [</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>TestMethod</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>]</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>void</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> GetTopRankedBuild_ReturnsBestBuild_Test()</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> build = </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Program</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.GetTopRankedBuild(sp, </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#A31515'>&quot;blah&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>, </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;blah&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Assert</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.AreEqual(2, build.Id);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Assert</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.AreEqual(</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#A31515'>&quot;secondBuild&quot;</span><span style='font-size:9.5pt;
  font-family:Consolas;color:black'>, build.BuildNumber);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    [</span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>TestMethod</span><span style='font-size:9.5pt;font-family:
  Consolas;color:black'>]</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>public</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>void</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> GetTopRankedBuild_QueriesEachBuildInBuildIds_Test()</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    {</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        </span><span style='font-size:9.5pt;font-family:Consolas;
  color:blue'>var</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'> build = </span><span style='font-size:9.5pt;font-family:Consolas;
  color:#2B91AF'>Program</span><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>.GetTopRankedBuild(sp, </span><span style='font-size:9.5pt;
  font-family:Consolas;color:#A31515'>&quot;blah&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>, </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#A31515'>&quot;blah&quot;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        vsts.Verify(x =&gt; x.GetBuild(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), 1), </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>Times</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.Once);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>        vsts.Verify(x =&gt; x.GetBuild(</span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>It</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.IsAny&lt;</span><span
  style='font-size:9.5pt;font-family:Consolas;color:blue'>string</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>&gt;(), 2), </span><span
  style='font-size:9.5pt;font-family:Consolas;color:#2B91AF'>Times</span><span
  style='font-size:9.5pt;font-family:Consolas;color:black'>.Once);</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
  color:black'>    }</span></p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:9.5pt;font-family:Consolas;color:black'>}</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<h1 style='margin-bottom:12.0pt'><a name="_Commentary_On_Iteration_2"></a><span
style='font-size:18.0pt;line-height:107%'>Commentary On Iteration 3</span></h1>

<p class=MsoNormal>The <span style='color:#4472C4'>ServiceProvider </span>class
is introduced as a container of services; it encapsulates the <span
style='color:#4472C4'>IVsts </span>and <span style='color:#4472C4'>IFileSystem </span>services.
The <span style='color:#4472C4'>GetTopRankedBuild </span><span
style='color:black'>is modified </span>to accept an instance of <span
style='color:#4472C4'>ServiceProvider </span>as its first parameter. The unit
tests were modified to populate a <span style='color:#4472C4'>ServiceProvider </span>with
mock <span style='color:#4472C4'>IVsts </span>and <span style='color:#4472C4'>IFileSystem
</span>services. This removes the use of static fields entirely, and creates a
scalable pattern for adding more services and passing services around the
program as it grows.</p>

<h1 style='margin-bottom:12.0pt'><span style='font-size:18.0pt;line-height:
107%'>Future Improvments</span></h1>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Add unit tests for failure scenarios</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Use a generic service provider</p>

<p class=MsoListParagraphCxSpLast style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>For example, var fileSystem =
serviceProvider.GetService&lt;IFileSystem&gt;()</p>

<h1><span style='font-size:18.0pt;line-height:107%'>Additional Reading</span></h1>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>&nbsp;</p>

<p class=MsoNormal style='line-height:normal'>Programmers like to argue over
terminology when it comes to unit testing. I use the verb mock to mean</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;line-height:normal'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Controlling
the return values of services</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;line-height:normal'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Verifying
services are called with the correct parameters</p>

<p class=MsoNormal style='line-height:normal'>For more reading, see <a
href="http://martinfowler.com/articles/mocksArentStubs.html">Mocks Arent Stubs</a>,
and a response to it, <a
href="http://blogs.clariusconsulting.net/kzu/mocks-stubs-and-fakes-its-a-continuum/">Mocks,
Stubs, and Fakes: its a continuum</a></p>

<p class=MsoNormal>&nbsp;</p>

</div>

</body>

</html>
